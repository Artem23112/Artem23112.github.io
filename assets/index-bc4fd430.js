import{j as s,r as u,R as yt}from"./react-f17a95de.js";import{c as re}from"./react-dom-61bf0eba.js";import{u as ae,a as ie,P as ce}from"./react-redux-ae3bbc54.js";import{L as ct,B as le}from"./react-router-dom-a55787a0.js";import{l as c}from"./runtypes-fe95303d.js";import{g as x,u as at,a as h,o as G,b as N,s as P,A as $,c as de,d as E,e as ue,f as pe,h as me,i as he,j as fe,k as _e,l as xe}from"./@firebase-01e90a33.js";import{h as S}from"./moment-1841ed88.js";import{c as j,a as X,b as ge}from"./@reduxjs-0dff851b.js";import{v as L}from"./uuid-4a60fe23.js";import"./hoist-non-react-statics-d052b204.js";import"./react-is-a192e302.js";import{d as Z,b as be,e as wt,f as T,a as lt,g as je}from"./react-router-00cdfa21.js";import{c as g}from"./clsx-1229b3e0.js";import{_ as Se}from"./moment-with-locales-es6-62e28ada.js";import{R as ye}from"./react-quill-439a743d.js";import{C as we}from"./react-calendar-40236c03.js";import{R as ve}from"./react-paginate-b0ba4c82.js";import"./firebase-d6c7c155.js";import"./scheduler-765c72db.js";import"./use-sync-external-store-0efa3301.js";import"./@remix-run-1dd2da88.js";import"./idb-81bdbf9b.js";import"./immer-41fd5235.js";import"./redux-550d7e81.js";import"./@babel-c7024f36.js";import"./redux-thunk-ef899f4c.js";import"./lodash-e13e2920.js";import"./quill-75e17b9d.js";import"./prop-types-1287e13b.js";import"./get-user-locale-32ab7647.js";import"./lodash.memoize-81ef9c90.js";import"./@wojtekmaj-0fa81e45.js";import"./tiny-warning-c932d744.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();const vt=e=>c.Intersect(e,c.Record({id:c.String})),De=c.Union(c.Literal("enrolled"),c.Literal("admitted"),c.Literal("not-admitted"),c.Literal("expired")),Dt=c.Record({status:De,fullDateISO:c.String}),Ie=c.Record({patientId:c.String,fullDateISO:c.String,record:c.String,doctorId:c.String}),It=c.Dictionary(Ie,c.String),$t=c.Record({name:c.String,specialization:c.String,additional:c.Record({education:c.String,experience:c.String})}),$e=vt($t),Nt=c.Dictionary($t,c.String),Ne=c.Intersect(Dt,c.Record({userId:c.String})),dt=c.Dictionary(Ne,c.String),Ae=c.Dictionary(c.Boolean,c.String),At=async(e,t,n)=>{e.forEach(o=>{if(S(o.fullDateISO).isBefore(S())&&o.status==="enrolled"){const r=x(),a=`${n==="admin"?"doctors":"users"}/${t}/appointments/${o.id}/`;at(h(r,a),{status:"expired"})}})},D=e=>e instanceof Object?Object.entries(e).map(([n,o])=>({id:n,...o})):[],Pt=e=>e.sort((t,n)=>t.fullDateISO.localeCompare(n.fullDateISO));function Pe(e,t){const n=h(x(),`doctors/${t}/appointments`);G(n,async o=>{const r=o.val();if(!dt.guard(r))return;const a=D(r);await At(a,t,"admin");const i=Pt(a);e(Oe(i))})}function Ce(e,t){const n=h(x(),`doctors/${t}/my-patients`);G(n,async o=>{const r=o.val();if(!Ae.guard(r))return;const a=Object.keys(r);e(Me(a))})}const Ct=c.Record({name:c.String}),Te=vt(Ct),ke=c.Dictionary(Ct,c.String),Re=c.Intersect(Dt,c.Record({doctorId:c.String})),Ee=c.Dictionary(Re,c.String),Tt=j("doctorSlice/doctorConnectToServer",async(e,{dispatch:t,rejectWithValue:n})=>{Pe(t,e),Ce(t,e);const o=h(x(),"users-info"),r=(await N(o)).val();if(!ke.guard(r))return n("unknown type info about users");const a=h(x(),"doctors-info"),i=(await N(a)).val();return Nt.guard(i)?{usersInfo:D(r),doctorsInfo:D(i)}:n("")}),k=j("doctorSlice/getMedicalCard",async(e,{rejectWithValue:t})=>{const n=x(),o=h(n,`users-info/${e}/medical-records`);try{const r=await N(o),a=r.val();if(!r.exists()||!It.guard(a))throw Error();return D(a)}catch{return t("")}}),Le={appointments:[],usersInfo:[],doctorsInfo:[],doctorPatients:[],medicalCard:[],isLoading:!1},kt=X({name:"doctorSlice",initialState:Le,reducers:{setDoctorAppointments(e,t){e.appointments=t.payload},setDoctorPatients(e,t){e.doctorPatients=t.payload}},extraReducers:e=>{e.addCase(Tt.fulfilled,(t,n)=>{t.usersInfo=n.payload.usersInfo,t.doctorsInfo=n.payload.doctorsInfo}).addCase(k.pending,t=>{t.isLoading=!0}).addCase(k.fulfilled,(t,n)=>{t.medicalCard=n.payload,t.isLoading=!1}).addCase(k.rejected,t=>{t.medicalCard=[],t.isLoading=!1})}}),{setDoctorAppointments:Oe,setDoctorPatients:Me}=kt.actions,Fe=kt.reducer,Rt=j("patientSlice/getMedicalCard",async(e,{rejectWithValue:t,getState:n})=>{const o=x(),a=n().authentication.id,i=h(o,`users-info/${a}/medical-records`);try{const l=await N(i),d=l.val();if(!l.exists()||!It.guard(d))throw Error();return D(d)}catch{return t("")}}),Be=[],Et=X({name:"popup-messages",initialState:Be,reducers:{addMessage(e,t){e.push(t.payload)},removeMessage(e,t){return e.filter(n=>n.id!==t.payload)}}}),R=j("popup-messages/show",async(e,{dispatch:t})=>{const n={...e,id:L()};t(Ue(n)),await new Promise(o=>{(n==null?void 0:n.duration)!==0&&setTimeout(()=>{t(Lt(n.id)),o("success")},(n==null?void 0:n.duration)||3e3)})}),{addMessage:Ue,removeMessage:Lt}=Et.actions,He=Et.reducer,qe=async e=>{const t=x(),n=h(t,`doctors/${e}/appointments`),o=await N(n),r=o.val();if(!o.exists())return[];if(!dt.guard(r))throw new Error("unknown type of doctor appointment data");return D(r).map(l=>l.fullDateISO)},ze=async(e,t)=>({isExists:(await qe(e)).some(r=>r===t)}),We=(e,t)=>{const n=S(t,"HH:mm");return S(e).hours(n.hours()).minutes(n.minutes()).seconds(0).milliseconds(0).toISOString()},Ot=j("patientSlice/sendApplication",async(e,{getState:t,dispatch:n,rejectWithValue:o})=>{const r=t(),{chosenDoctor:a,chosenDate:i,chosenTime:l}=r.patientSlice.appointmentData;if(!a||!i||!l)return n(R({text:"Извините, но вы выбрали не все, что необходимо для записи",type:"warning"})),o("Данных недостаточно");const d=x(),w=We(i,l),_=r.authentication.id,I={status:"enrolled",fullDateISO:w},M=L(),J=h(d,`doctors/${a}/appointments/${M}`),tt=h(d,`users/${_}/appointments/${M}`);try{const{isExists:et}=await ze(a,w);if(et)throw new Error("Запись на данное число уже есть");P(J,{...I,userId:_}),P(tt,{...I,doctorId:a}),n(R({text:"Вы записались к врачу",type:"success"}))}catch(et){const oe=et.message||"Упс, что-то пошло не так, записаться не удалось";return n(R({text:oe,type:"error"})),o("")}}),Ye={userAppointments:[],doctorsInfo:[],usersInfo:[],isSuccessSubmit:!1,busyDates:[],appointmentData:{chosenDoctor:null,chosenDate:null,chosenTime:null},medicalRecords:[]},Mt=X({name:"patientSlice",initialState:Ye,reducers:{setPatientAppointments(e,t){e.userAppointments=t.payload},setBusyDates(e,t){e.busyDates=t.payload},clearSubmitStatus(e){e.isSuccessSubmit=!1},setChosenAppointmentData(e,t){e.appointmentData={...e.appointmentData,...t.payload}}},extraReducers:e=>{e.addCase(pt.fulfilled,(t,n)=>{t.doctorsInfo=n.payload}).addCase(Ot.fulfilled,t=>{t.isSuccessSubmit=!0,t.appointmentData={chosenDoctor:null,chosenDate:null,chosenTime:null}}).addCase(Rt.fulfilled,(t,n)=>{t.medicalRecords=n.payload})}}),Ft=e=>e.patientSlice.doctorsInfo,Ve=e=>e.patientSlice.isSuccessSubmit,Ke=e=>e.patientSlice.busyDates,Qe=e=>e.patientSlice.appointmentData.chosenDoctor,Bt=e=>e.patientSlice.appointmentData.chosenDate,Ge=e=>e.patientSlice.appointmentData.chosenTime,{setPatientAppointments:Xe,clearSubmitStatus:Ze,setBusyDates:ft,setChosenAppointmentData:ut}=Mt.actions,Je=Mt.reducer;function ts(e,t){const n=h(x(),`users/${t}/appointments`);G(n,async o=>{const r=o.val();if(!Ee.guard(r))return;const a=D(r);await At(a,t,"user");const i=Pt(a);e(Xe(i))})}const pt=j("patientSlice/patientConnectToServer",async(e,{dispatch:t,rejectWithValue:n})=>{ts(t,e),t(Rt());const o=h(x(),"doctors-info"),r=(await N(o)).val();return Nt.guard(r)?D(r):n("unknown type info about doctors")}),K=j("authentication/connect",async(e,{dispatch:t,rejectWithValue:n,getState:o})=>{try{const a=o().authentication.id;if(!a)throw new Error("Пользователь не авторизован");return(await N(h(x(),`doctors-info/${a}`))).exists()?(t(Tt(a)),"admin"):(t(pt(a)),"user")}catch(r){return n(r.code)}}),mt=e=>{switch(e){case $.INVALID_EMAIL:return{type:"email-error",message:"Неверный формат email."};case $.EMAIL_EXISTS:return{type:"email-error",message:"Email уже используется другим пользователем."};case $.USER_DELETED:return{type:"email-error",message:"Пользователь с указанным email не найден."};case $.USER_DISABLED:return{type:"email-error",message:"Учетная запись пользователя отключена."};case $.WEAK_PASSWORD:return{type:"pw-error",message:"Слабый пароль."};case $.INVALID_PASSWORD:return{type:"pw-error",message:"Неверный пароль."};case $.NETWORK_REQUEST_FAILED:return{type:"error",message:"Кажется какие-то проблемы с сетью."};case $.TOO_MANY_ATTEMPTS_TRY_LATER:return{type:"error",message:"Сервер слишком нагружен, попробуйте позже."};case null:return{type:null,message:null};default:return{type:"error",message:"Извините произошла какая-то ошибка, перезагрузите страницу"}}},z=j("authentication/exit",async(e,{rejectWithValue:t})=>{try{await de(E())}catch(n){return t({...mt(n.code)})}}),W=j("authentication/signIn",async({email:e,password:t},{rejectWithValue:n,dispatch:o})=>{try{const{user:r}=await ue(E(),e,t);return o(K()),{email:r.email,id:r.uid}}catch(r){return n({error:mt(r.code)})}}),Y=j("authentication/signUp",async({email:e,password:t,name:n},{rejectWithValue:o,dispatch:r})=>{try{const{user:a}=await pe(E(),e,t),i=a.uid;return await P(h(x(),`users-info/${i}/rights`),"user"),await P(h(x(),`users-info/${i}/name`),n),r(pt(i)),{email:a.email,id:i}}catch(a){return o({error:{...mt(a.code),page:"/signup"}})}}),es={email:null,id:null,isAuth:!1,rights:null,loading:!1,error:null},Ut=X({name:"authentication",initialState:es,reducers:{setSavedUser(e,t){const{email:n,id:o,isAuth:r}=t.payload;e.error=null,e.email=n,e.id=o,e.isAuth=r},clearError(e){e.error=null}},extraReducers:e=>{e.addCase(Y.fulfilled,(t,n)=>{const{email:o,id:r}=n.payload;t.email=o,t.id=r,t.isAuth=!0,t.loading=!1,t.error=null}).addCase(W.fulfilled,(t,n)=>{const{email:o,id:r}=n.payload;t.email=o,t.id=r,t.isAuth=!0,t.loading=!1,t.error=null}).addCase(z.fulfilled,t=>{t.email=null,t.id=null,t.isAuth=!1,t.rights=null,t.loading=!1,t.error=null}).addCase(K.fulfilled,(t,n)=>{t.rights=n.payload}).addMatcher(t=>t.type===Y.pending.type||t.type===W.pending.type||t.type===z.pending.type,t=>{t.loading=!0}).addMatcher(t=>t.type===Y.rejected.type||t.type===W.rejected.type||t.type===z.rejected.type||t.type===K.rejected.type,(t,n)=>{t.error=n.payload.error,t.loading=!1})}}),Ht=e=>e.authentication.loading,qt=e=>e.authentication.error,{setSavedUser:ss,clearError:zt}=Ut.actions,ns=Ut.reducer,os=ge({reducer:{authentication:ns,doctorSlice:Fe,patientSlice:Je,popupMessage:He},devTools:!0}),y=ae,p=ie,Wt=({children:e})=>p(n=>n.authentication.isAuth)?s.jsx(s.Fragment,{children:e}):s.jsx(Z,{to:"/login"}),rs=e=>me(E(),n=>{n&&(e(ss({email:n.email,id:n.uid,isAuth:!0})),e(K()))}),as="_wrapper_1e9ia_3",is={wrapper:as},Yt=({contentText:e,linkText:t,redirectPath:n,handleClick:o})=>s.jsxs("p",{className:is.wrapper,children:[e,s.jsx(ct,{to:n,onClick:o,children:t})]}),cs="_btn_15hr8_10",ls="_input_15hr8_27",ds="_err_15hr8_3",st={"err-message":"_err-message_15hr8_3",btn:cs,input:ls,err:ds},it=({className:e,isError:t,errMessage:n,...o})=>s.jsxs("label",{children:[t&&s.jsx("span",{className:st["err-message"],children:n}),s.jsx("input",{className:g(st.input,{[st.err]:t},e),...o})]}),us="_form_1stak_3",ps="_btn_1stak_9",ms={form:us,btn:ps},Vt=({children:e,submitBtnContent:t,submitHandler:n,error:o})=>{const[r,a]=u.useState(""),[i,l]=u.useState(""),d=(o==null?void 0:o.type)==="email-error",w=(o==null?void 0:o.type)==="pw-error";return s.jsxs("form",{onSubmit:_=>{_.preventDefault(),n(r,i)},children:[e,s.jsx(it,{type:"email",value:r,onChange:_=>a(_.target.value),placeholder:"Логин",isError:d,errMessage:o==null?void 0:o.message,required:!0}),s.jsx(it,{type:"password",value:i,onChange:_=>l(_.target.value),placeholder:"Пароль",isError:w,errMessage:o==null?void 0:o.message,required:!0}),s.jsx("button",{className:ms.btn,type:"submit",children:t})]})},hs="_loader_1gmtn_3",fs="_rotation_1gmtn_1",_s={loader:hs,rotation:fs},ht=({size:e,color:t})=>{const n={width:`${e}px`,height:`${e}px`,borderWidth:`${Math.floor(e/10)}px`,borderColor:t,borderBottomColor:"transparent"};return s.jsx("span",{className:_s.loader,style:n})},xs="_container_pbous_3",gs={container:xs},O=({children:e,className:t})=>s.jsx("div",{className:g(gs.container,t),children:e}),m={home:"/",login:"/login",singUp:"/signup",profile:{home:"/profile/",makeAppointment:"make-appointment/",appointmentList:"appointment-list/",myPatients:"my-patients/"}},bs="_title_hrqi1_16",_t={"login-wrapper":"_login-wrapper_hrqi1_3",title:bs,"err-message":"_err-message_hrqi1_23"},js=()=>{const e=y(),t=p(Ht),n=p(qt);function o(r,a){e(W({email:r,password:a}))}return s.jsx(O,{children:s.jsxs("div",{className:_t["login-wrapper"],children:[s.jsx("h3",{className:_t.title,children:"Вход в аккаунт"}),s.jsx(Vt,{submitBtnContent:t?s.jsx(ht,{size:24,color:"#fff"}):"Войти",submitHandler:o,error:n}),s.jsx(Yt,{contentText:"Нет аккаунта?",linkText:"Регистрация",redirectPath:m.singUp,handleClick:()=>e(zt())})]})})},Q=({requiredRights:e,children:t})=>{const n=p(o=>o.authentication.rights);return s.jsx(s.Fragment,{children:e===n&&s.jsx(s.Fragment,{children:t})})},Ss="_tab_1uvki_3",ys="_active_1uvki_12",ws="_shadow_1uvki_34",F={"tab-list":"_tab-list_1uvki_3",tab:Ss,active:ys,shadow:ws},Kt=({tabsConfig:e})=>{const{pathname:t}=be();function n(o){return t.includes(o)}return s.jsxs(s.Fragment,{children:[s.jsx("ul",{className:F["tab-list"],children:e.map(o=>{if(!(o!=null&&o.default))return s.jsx("li",{className:g(F.tab,{[F.active]:n(o.linkPath)}),children:s.jsx(ct,{to:o.linkPath,children:o==null?void 0:o.tabText})},o.id)})}),s.jsx("div",{className:F.shadow,children:s.jsx(wt,{children:e.map(o=>s.jsx(T,{path:o==null?void 0:o.routePath,element:o.component},o.id))})})]})},vs=j("doctorSlice/addToOwnPatients",async(e,{getState:t,rejectWithValue:n,fulfillWithValue:o})=>{const r=x(),i=t().authentication.id,l=h(r,`doctors/${i}/my-patients/${e}`);if((await N(l)).exists())return o("already added");try{await P(l,!0)}catch{return n("something went wrong")}}),Ds=j("doctorSlice/doctorAnswer",async({userId:e,appointmentId:t,type:n},{getState:o,dispatch:r})=>{const i=o().authentication.id,l=x(),d=h(l,`users/${e}/appointments/${t}`),w=h(l,`doctors/${i}/appointments/${t}`);try{await at(d,{status:n}),await at(w,{status:n})}catch{r(R({text:"Упс, что-то пошло не так",type:"error"}))}}),Is="_wrapper_9nua0_3",$s="_active_9nua0_35",Ns="_title_9nua0_38",As="_additional_9nua0_39",Ps="_time_9nua0_40",Cs="_icon_9nua0_66",Ts="_status_9nua0_73",ks="_enrolled_9nua0_76",Rs="_admitted_9nua0_79",Es="_accept_9nua0_120",Ls="_cancel_9nua0_126",b={wrapper:Is,"functional-btns-wrapper":"_functional-btns-wrapper_9nua0_29","btn-delete":"_btn-delete_9nua0_32",active:$s,title:Ns,additional:As,time:Ps,icon:Cs,status:Ts,enrolled:ks,admitted:Rs,"not-admitted":"_not-admitted_9nua0_82","functional-btn":"_functional-btn_9nua0_29",accept:Es,cancel:Ls},Os=({id:e,userId:t})=>{const n=y();function o(r){t&&(r==="admitted"&&n(vs(t)),n(Ds({userId:t,appointmentId:e,type:r})))}return s.jsxs("div",{className:b["functional-btns-wrapper"],children:[s.jsx("button",{className:g(b["functional-btn"],b.accept),onClick:()=>{o("admitted")},children:"Пациент принят"}),s.jsx("button",{className:g(b["functional-btn"],b.cancel),onClick:()=>{o("not-admitted")},children:"Пациент не пришел"})]})},Ms=({className:e,name:t,specialization:n})=>s.jsxs("span",{className:g(e),children:[s.jsx("h4",{className:b.title,children:t}),n&&s.jsx("p",{className:b.additional,children:n})]}),Qt="/assets/close-a79845a6.svg",Fs=j("appointments",async(e,{getState:t,dispatch:n})=>{const o=t(),r=o.authentication.id,a=o.authentication.rights,i=h(x(),`${a==="user"?"users":"doctors"}/${r}/appointments/${e}`);try{await he(i)}catch{n(R({text:"Не удалось удалить запись",type:"error"}))}}),Bs=({id:e})=>{const t=y();return s.jsx("button",{className:b["btn-delete"],onClick:()=>{t(Fs(e))},children:s.jsx("img",{src:Qt})})},Us=e=>({enrolled:"Записан",admitted:"Был принят","not-admitted":"Не принят",expired:"Запись просрочена"})[e],Hs=e=>({enrolled:"Вы записаны",admitted:"Вы были приняты","not-admitted":"Вы не были приняты",expired:"Запись просрочена"})[e],qs=({status:e})=>s.jsxs("div",{className:g(b.status,b[e]),children:[s.jsx(Q,{requiredRights:"admin",children:Us(e)}),s.jsx(Q,{requiredRights:"user",children:Hs(e)})]}),zs="/assets/calendar-2620e6bf.svg",Ws="/assets/time-f0281237.svg",Ys=(e,t)=>{if(!e)return[null,null];const[n,o]=u.useState(null),[r,a]=u.useState(null);return u.useEffect(()=>{const i=Se(e).locale("ru"),l=i.format("D MMMM YYYY"),d=`${i.format("HH:mm")} - ${i.add(t.count,t.what).format("HH:mm")}`;o(l),a(d)},[e]),[n,r]},Vs=({className:e,fullDateISO:t,textDate:n,textTime:o})=>{const[r,a]=Ys(t,{count:30,what:"minutes"});return s.jsx("div",{className:g(b.time,e),children:s.jsxs("div",{children:[s.jsxs("span",{children:[s.jsx("img",{className:b.icon,src:zs}),r||n]}),s.jsxs("span",{children:[s.jsx("img",{className:b.icon,src:Ws}),a||o]})]})})},f=({className:e,children:t,active:n,handleClick:o})=>s.jsx("div",{className:g(e,b.wrapper,{[b.active]:n}),style:{cursor:n==!1||n==!0?"pointer":""},onClick:()=>o==null?void 0:o(),children:t});f.About=Ms;f.TimeInfo=Vs;f.DeleteBtn=Bs;f.Status=qs;f.AnswerBtns=Os;function Gt(e,t){return e.find(n=>n.id===t)}const Ks="_list_12ica_1",Qs="_link_12ica_7",Gs="_card_12ica_11",Xs="_about_12ica_11",B={list:Ks,link:Qs,card:Gs,about:Xs},Zs=({})=>{const e=p(n=>n.doctorSlice.doctorPatients),t=p(n=>n.doctorSlice.usersInfo);return s.jsx("ul",{className:B.list,children:e.map(n=>{const o=Gt(t,n);return o?s.jsx("li",{children:s.jsx(ct,{className:B.link,to:`/profile/my-patients/${n}`,children:s.jsx(f,{className:B.card,children:s.jsx(f.About,{className:B.about,name:o.name})})})},n):s.jsx(u.Fragment,{},n)})})},Js=({className:e=""})=>{const t=lt(),n=()=>{t(-1)},o={display:"flex",alignItems:"center",juctifyContent:"center",padding:"8px 20px 10px",backgroundColor:"white",color:"#006ed0",fontSize:"30px",lineHeight:"30px",border:"none",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 -1px 4px rgba(0, 0, 0, 0.1)",transition:"background-color 0.3s ease"},r=()=>{n()};return s.jsx("button",{className:g(e),style:o,onClick:r,children:"←"})},tn="_btn_4tu26_3",en={btn:tn},Xt=({className:e,children:t,onClick:n})=>s.jsx("button",{className:g(e,en.btn),onClick:n,children:t}),sn=({htmlContent:e,className:t})=>s.jsx("div",{className:g(t),dangerouslySetInnerHTML:{__html:e}}),nn="_record_6g619_1",on="_name_6g619_6",rn="_additional_6g619_11",A={record:nn,name:on,additional:rn,"report-header":"_report-header_6g619_17","html-wrapper":"_html-wrapper_6g619_35"},Zt=({record:e,doctorInfo:t})=>s.jsxs("div",{className:A.record,children:[s.jsxs("div",{className:A["report-header"],children:[s.jsx("h4",{className:A.name,children:t==null?void 0:t.name}),s.jsx("h5",{className:A.additional,children:t==null?void 0:t.specialization})]}),s.jsx(sn,{className:A["html-wrapper"],htmlContent:e.record})]},e.id);function Jt(e,t){return e.find(n=>n.id===t)}const an=({})=>{const e=p(n=>n.doctorSlice.medicalCard),t=p(n=>n.doctorSlice.doctorsInfo);return s.jsx("div",{className:A.container,children:e.map(n=>{const o=Jt(t,n.doctorId);return s.jsx(Zt,{record:n,doctorInfo:o},n.id)})})},cn=({value:e,setValue:t})=>s.jsx(ye,{style:{height:"300px"},theme:"snow",value:e,onChange:t}),ln=j("doctorSlice/addRecordToCard",async(e,{getState:t,rejectWithValue:n})=>{const o=x(),r=h(o,`users-info/${e.patientId}/medical-records/${L()}`),i=t().authentication.id,l={...e,doctorId:i};try{await P(r,l)}catch{return n("error")}}),dn="_title_1y3d6_5",un="_btn_1y3d6_15",C={"back-button":"_back-button_1y3d6_1",title:dn,"btn-wrapper":"_btn-wrapper_1y3d6_15",btn:un,"loader-wrapper":"_loader-wrapper_1y3d6_24"},pn=({patientId:e})=>{var l;const t=y(),n=p(d=>d.doctorSlice.isLoading),o=p(d=>d.doctorSlice.usersInfo),[r,a]=u.useState("");u.useEffect(()=>{t(k(e))},[]);function i(){const d={patientId:e,fullDateISO:S().toISOString(),record:r};a(""),t(ln(d)),t(k(e))}return s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx(Js,{className:C["back-button"]}),s.jsxs("h2",{className:C.title,children:[s.jsx("span",{children:"Пациент:"})," ",(l=Gt(o,e))==null?void 0:l.name]})]}),s.jsx(cn,{value:r,setValue:a}),s.jsx("div",{className:C["btn-wrapper"],children:s.jsx(Xt,{className:C.btn,onClick:i,children:"Добавить запись"})}),n?s.jsx("div",{className:C["loader-wrapper"],children:s.jsx(ht,{color:"#006ed0",size:40})}):s.jsx(an,{patientId:e})]})},mn="_wrapper_1m45x_1",hn={wrapper:mn},fn=({})=>{const{patientId:e}=je();return s.jsx("div",{className:hn.wrapper,children:e?s.jsx(pn,{patientId:e}):s.jsx(Zs,{})})},_n="/assets/arrow-60e4b77b.svg",xn="_active_1v3fb_35",v={"profile-btn-container":"_profile-btn-container_1v3fb_3","profile-btn":"_profile-btn_1v3fb_3","profile-btn__name":"_profile-btn__name_1v3fb_14","profile-btn__arrow":"_profile-btn__arrow_1v3fb_17","profile-btn__submenu":"_profile-btn__submenu_1v3fb_22",active:xn,"profile-btn__submenu-item":"_profile-btn__submenu-item_1v3fb_38"},gn=()=>{const e=p(a=>a.authentication.email),[t,n]=u.useState(!1),o=y(),r=u.useCallback(({target:a})=>{a instanceof HTMLElement&&(a.closest("."+v["profile-btn-container"])||n(i=>!i))},[]);return u.useEffect(()=>{if(!t){document.removeEventListener("click",r);return}return document.addEventListener("click",r),()=>{document.removeEventListener("click",r)}},[t,r]),s.jsxs("div",{className:v["profile-btn-container"],children:[s.jsxs("button",{className:v["profile-btn"],onClick:()=>{n(!t)},children:[s.jsx("span",{className:v["profile-btn__name"],children:e}),s.jsx("img",{className:v["profile-btn__arrow"],src:_n})]}),s.jsxs("ul",{className:`${v["profile-btn__submenu"]} ${t?v.active:""}`,children:[s.jsx("li",{className:v["profile-btn__submenu-item"],children:s.jsx("button",{children:"Параметры"})}),s.jsx("li",{className:v["profile-btn__submenu-item"],children:s.jsx("button",{onClick:()=>{o(z())},children:"Выход"})})]})]})},bn="_header_1n6cy_3",nt={header:bn,"header-content":"_header-content_1n6cy_7","header-title":"_header-title_1n6cy_12"},te=({title:e})=>s.jsx("div",{className:nt.header,children:s.jsx(O,{children:s.jsxs("div",{className:nt["header-content"],children:[s.jsx("h2",{className:nt["header-title"],children:e}),s.jsx(Wt,{children:s.jsx(gn,{})})]})})}),jn="_btn_105nh_3",Sn="_active_105nh_24",U={"btns-wrapper":"_btns-wrapper_105nh_3","btn-wrapper":"_btn-wrapper_105nh_10",btn:jn,active:Sn},yn=({className:e,sortConfig:t,chosenFilter:n,handleClick:o})=>s.jsx("ul",{className:g(U["btns-wrapper"],e),children:t.map(r=>s.jsx("li",{className:U["btn-wrapper"],children:s.jsx("button",{className:g(U.btn,{[U.active]:n===r.filter}),onClick:()=>{o(r.filter)},children:r.btnText})},L()))});const ee=e=>s.jsx(we,{className:"react-calendar",...e}),se=c.Union(c.InstanceOf(Date),c.Null),wn=(e,t,n)=>{const[o,r]=u.useState(t),[a,i]=u.useState([]),l=d=>S(d.fullDateISO).startOf("day").toISOString()===n;return u.useEffect(()=>{i(o==="all"?e.filter(l):e.filter(d=>d.status===o).filter(l))},[o,n,e]),{handledList:a,chosenFilter:o,setChosenFilter:r}},vn="_message_5iue8_8",xt={"appointments-list":"_appointments-list_5iue8_3",message:vn},Dn=({className:e,doctorAppointments:t})=>{const n=p(o=>o.doctorSlice.usersInfo);return s.jsxs("ul",{className:g(xt["appointments-list"],e),children:[t.map((o,r)=>{const a=n.find(i=>i.id===o.userId);return Te.guard(a)?s.jsx("li",{children:s.jsxs(f,{children:[o.status==="enrolled"&&s.jsx(f.AnswerBtns,{id:o.id,userId:o.userId}),s.jsx(f.About,{name:a.name}),s.jsx(f.TimeInfo,{fullDateISO:o.fullDateISO}),s.jsx(f.Status,{status:o.status})]})},o.id):s.jsx(u.Fragment,{},r)}),s.jsx("p",{className:xt.message,children:!t.length&&"Нет пациентов за выбранную дату и сортировку"})]})},In="_wrapper_xtoys_1",$n="_calendar_xtoys_7",H={wrapper:In,calendar:$n,"sort-btns-wrapper":"_sort-btns-wrapper_xtoys_19","appointment-list":"_appointment-list_xtoys_24"},Nn=[{filter:"all",btnText:"Все"},{filter:"enrolled",btnText:"Записанные"},{filter:"admitted",btnText:"Принятые"},{filter:"not-admitted",btnText:"Не принятые"},{filter:"expired",btnText:"Просроченные"}],An=({doctorAppointments:e})=>{const[t,n]=u.useState(S().startOf("day").toISOString()),{handledList:o,chosenFilter:r,setChosenFilter:a}=wn(e,"all",t);return s.jsx(s.Fragment,{children:s.jsxs("div",{className:H.wrapper,children:[s.jsx(yn,{className:H["sort-btns-wrapper"],sortConfig:Nn,chosenFilter:r,handleClick:a}),s.jsx(Dn,{className:H["appointment-list"],doctorAppointments:o}),s.jsx(ee,{className:H.calendar,value:S(t).toDate(),onChange:i=>se.guard(i)&&n(S(i).toISOString())})]})})},Pn=()=>{const e=p(n=>n.doctorSlice.appointments);let t=[{id:1,tabText:"Список записей",linkPath:`${m.profile.home}${m.profile.appointmentList}`,routePath:`${m.profile.appointmentList}`,component:s.jsx(An,{doctorAppointments:e})},{id:2,tabText:"Мои пациенты",linkPath:`${m.profile.home}${m.profile.myPatients}`,routePath:`${m.profile.myPatients}:patientId?`,component:s.jsx(fn,{})},{id:3,linkPath:"",routePath:`${m.home}`,component:s.jsx(Z,{to:`./${m.profile.appointmentList}`}),default:!0}];return s.jsxs(s.Fragment,{children:[s.jsx(te,{title:"Добро пожаловать"}),s.jsx(O,{children:s.jsx(Kt,{tabsConfig:t})})]})},Cn="_wrapper_1mkkx_1",Tn={wrapper:Cn},kn=({})=>{const e=p(n=>n.patientSlice.medicalRecords),t=p(n=>n.patientSlice.doctorsInfo);return s.jsx("div",{className:Tn.wrapper,children:e.map(n=>s.jsx(Zt,{record:n,doctorInfo:Jt(t,n.doctorId)},n.id))})},Rn="_btn_x82fc_3",En="_chosen_x82fc_27",ot={"btns-wrapper":"_btns-wrapper_x82fc_3",btn:Rn,chosen:En},ne=({from:e,to:t,stepSize:n,busyDates:o})=>{const r=y(),a=p(Bt),i=p(Ge),[l,d]=u.useState([]);u.useEffect(()=>{const _=[],I=S(a).hours(e.hours).minutes(e.minutes).seconds(0).milliseconds(0),M=S(I).hours(t.hours).minutes(t.minutes);for(;!I.isSameOrAfter(M);){const J={text:I.format("HH:mm"),isDisabled:o.some(tt=>tt===I.toISOString())};_.push(J),I.add(n.hours,"hours").add(n.minutes,"minutes")}d(_)},[e,t,n]);function w(_){r(ut({chosenTime:_}))}return s.jsx("div",{className:ot["btns-wrapper"],children:l.map(_=>s.jsx("button",{className:g(ot.btn,{[ot.chosen]:_.text===i}),disabled:_.isDisabled,onClick:()=>{w(_.text)},children:_.text},L()))})};yt.memo(ne);const Ln="_title_g1ug0_3",rt={title:Ln,"content-container":"_content-container_g1ug0_14","record-calendary":"_record-calendary_g1ug0_28"},On=()=>{const e=y(),t=p(Ke),n=p(Bt),o=u.useMemo(()=>({from:{hours:8,minutes:0},to:{hours:17,minutes:0},stepSize:{hours:0,minutes:30},busyDates:t,chosenDate:n}),[t,n]);function r(a){se.guard(a)&&a&&e(ut({chosenDate:a.toISOString()}))}return s.jsxs("div",{children:[s.jsx("h2",{className:rt.title,children:"Выберите дату и время"}),s.jsxs("div",{className:rt["content-container"],children:[s.jsx(ee,{className:rt["record-calendar"],maxDate:S().add(1,"month").toDate(),minDate:S().add(1,"day").toDate(),maxDetail:"month",minDetail:"year",value:n&&S(n).toDate(),onChange:a=>{r(a)},tileDisabled:({date:a,view:i})=>i==="month"&&(a.getDay()===0||a.getDay()===6)}),n&&s.jsx(ne,{...o})]})]})},Mn=j("appointments",async(e,{dispatch:t,rejectWithValue:n})=>{const o=h(x(),`doctors/${e}/appointments`);G(o,r=>{const a=r.val();if(!r.exists())return t(ft([]));if(!dt.guard(a))return n("unknown type of doctor appointment data");const l=D(a).map(d=>d.fullDateISO);t(ft(l))})}),Fn="_title_e74vm_3",gt={title:Fn},Bn=({doctorsInfo:e})=>{const t=y(),n=p(Qe);u.useEffect(()=>{n&&t(Mn(n))},[n]);function o(r){t(ut({chosenDoctor:r}))}return s.jsxs("div",{children:[s.jsx("h2",{className:gt.title,children:"Выберите врача"}),s.jsx("ul",{className:gt["doctor-list"],children:e.map(r=>s.jsx("li",{children:s.jsxs(f,{active:n===r.id,handleClick:()=>o(r.id),children:[s.jsx(f.About,{name:r.name,specialization:r.specialization}),s.jsx(f.TimeInfo,{textDate:"Пн-Пт",textTime:"8:00-17:00"})]})},r.id))})]})},bt={"content-wrapper":"_content-wrapper_1u7nq_3"},Un=()=>{const e=y(),t=lt(),n=p(Ft),o=p(Ve);return u.useEffect(()=>{o&&(t(m.profile.home+m.profile.appointmentList),e(Ze()))},[o]),s.jsx(s.Fragment,{children:s.jsxs("div",{className:bt["content-wrapper"],children:[s.jsx(Bn,{doctorsInfo:n}),s.jsx(On,{}),s.jsx(Xt,{className:g(bt.end),onClick:()=>{e(Ot())},children:"Записаться"})]})})},Hn="_container_4rbos_3",qn="_active_4rbos_12",V={container:Hn,active:qn};console.log(V);const zn={activeClassName:V.active,disabledClassName:V.disabled,containerClassName:V.container},Wn=({page:e,countItemsOnPage:t,data:n})=>{const[o,r]=u.useState(e),[a,i]=u.useState([]);return u.useEffect(()=>{i(n.filter((l,d)=>d>=o*t&&d<(o+1)*t))},[o]),{setCurrentPage:r,itemsToRender:a}},Yn="_message_5iue8_8",jt={"appointments-list":"_appointments-list_5iue8_3",message:Yn},Vn=({className:e,userAppointments:t})=>{const n=p(Ft),o=5,{itemsToRender:r,setCurrentPage:a}=Wn({page:0,countItemsOnPage:o,data:t});return s.jsxs(s.Fragment,{children:[s.jsx("ul",{className:g(jt["appointments-list"],e),children:r.map(i=>{const l=n.find(d=>d.id===i.doctorId);return $e.guard(l)?s.jsx("li",{children:s.jsxs(f,{children:[s.jsx(f.About,{name:l.name,specialization:l.specialization}),s.jsx(f.TimeInfo,{fullDateISO:i.fullDateISO}),s.jsx(f.Status,{status:i.status}),s.jsx(f.DeleteBtn,{id:i.id})]})},i.id):s.jsx(u.Fragment,{},i.id)})}),s.jsx(ve,{pageCount:Math.ceil(t.length/o),onPageChange:i=>a(i.selected),renderOnZeroPageCount:null,...zn}),!t.length&&s.jsx("p",{className:jt.message,children:"'У вас нет никаких записей'"})]})},Kn=()=>{const e=p(n=>n.patientSlice.userAppointments),t=[{id:1,tabText:"Записаться",linkPath:m.profile.home+m.profile.makeAppointment,routePath:m.profile.makeAppointment,component:s.jsx(Un,{})},{id:2,tabText:"Список записей",linkPath:m.profile.home+m.profile.appointmentList,routePath:m.profile.appointmentList,component:s.jsx(Vn,{userAppointments:e})},{id:3,tabText:"Медицинская карта",linkPath:m.profile.home+"my-medical-card",routePath:"/my-medical-card",component:s.jsx(kn,{})},{id:4,linkPath:"",routePath:"/",component:s.jsx(Z,{to:m.profile.makeAppointment}),default:!0}];return s.jsxs(s.Fragment,{children:[s.jsx(te,{title:"Запишитесь на прием"}),s.jsx(O,{children:s.jsx(Kt,{tabsConfig:t})})]})},Qn=()=>s.jsxs("div",{children:[s.jsx(Q,{requiredRights:"user",children:s.jsx(Kn,{})}),s.jsx(Q,{requiredRights:"admin",children:s.jsx(Pn,{})})]}),Gn="_title_1xg3z_16",St={"signup-wrapper":"_signup-wrapper_1xg3z_3",title:Gn},Xn=()=>{const[e,t]=u.useState(""),n=y(),o=p(Ht),r=p(qt);function a(i,l){n(Y({email:i,password:l,name:e}))}return s.jsx(O,{children:s.jsxs("div",{className:St["signup-wrapper"],children:[s.jsx("h3",{className:St.title,children:"Регистрация"}),s.jsx(Vt,{submitHandler:a,submitBtnContent:o?s.jsx(ht,{size:24,color:"#fff"}):"Зарегистрироваться",error:r&&{type:r.type,message:r.message},children:s.jsx(it,{type:"name",value:e,onChange:i=>t(i.target.value),placeholder:"ФИО",required:!0})}),s.jsx(Yt,{contentText:"Уже есть аккаунт?",linkText:"Войти",redirectPath:m.login,handleClick:()=>n(zt())})]})})},Zn=()=>{const e=y(),t=p(({authentication:o})=>o.isAuth),n=lt();return u.useEffect(()=>{let o=rs(e);return()=>void o()},[]),u.useEffect(()=>{t&&n(m.profile.home)},[t]),s.jsx(s.Fragment,{children:s.jsxs(wt,{children:[s.jsx(T,{path:m.home,element:s.jsx(Z,{to:m.login})}),s.jsx(T,{path:m.login,element:s.jsx(js,{})}),s.jsx(T,{path:m.singUp,element:s.jsx(Xn,{})}),s.jsx(T,{path:`${m.profile.home}*`,element:s.jsx(Wt,{children:s.jsx(Qn,{})})})]})})},Jn={error:"Ошибка",success:"Успех",warning:"Предупреждение",information:"Информация"},to="_title_xtytf_14",eo="_error_xtytf_25",so="_warning_xtytf_29",no="_success_xtytf_33",oo="_information_xtytf_37",q={"popup-message":"_popup-message_xtytf_3",title:to,"close-btn":"_close-btn_xtytf_19",error:eo,warning:so,success:no,information:oo},ro=({type:e,text:t,id:n})=>{const o=y();return s.jsxs("div",{className:g(q[e],q["popup-message"]),children:[s.jsxs("div",{children:[s.jsx("h4",{className:q.title,children:Jn[e]}),s.jsx("p",{children:t})]}),s.jsx("button",{className:q["close-btn"],type:"button",onClick:()=>{o(Lt(n))},children:s.jsx("img",{src:Qt})})]})},ao={"messages-wrapper":"_messages-wrapper_su4a9_1"},io=()=>{const e=p(t=>t.popupMessage);return s.jsx("div",{className:ao["messages-wrapper"],children:e.map(t=>s.jsx(ro,{type:t.type,text:t.text,id:t.id},t.id))})},co={apiKey:"AIzaSyDLCk35bsbIUHlSrrvkmWVb0OlLkEMRyBk",authDomain:"hospital-1651b.firebaseapp.com",projectId:"hospital-1651b",storageBucket:"hospital-1651b.appspot.com",messagingSenderId:"180699288079",appId:"1:180699288079:web:00e15fb90caaf4ca03c97a"},lo=fe(co);_e(E(lo),xe);re.createRoot(document.getElementById("root")).render(s.jsx(yt.StrictMode,{children:s.jsxs(ce,{store:os,children:[s.jsx(io,{}),s.jsx(le,{children:s.jsx(Zn,{})})]})}));
